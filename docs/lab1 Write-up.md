          <!-- /\* Font Definitions \*/ @font-face {font-family:Helvetica; panose-1:2 11 6 4 2 2 2 2 2 4; mso-font-charset:0; mso-generic-font-family:swiss; mso-font-pitch:variable; mso-font-signature:-536858881 -1073711013 9 0 511 0;} @font-face {font-family:Wingdings; panose-1:5 0 0 0 0 0 0 0 0 0; mso-font-charset:2; mso-generic-font-family:auto; mso-font-pitch:variable; mso-font-signature:0 268435456 0 0 -2147483648 0;} @font-face {font-family:"Cambria Math"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536869121 1107305727 33554432 0 415 0;} @font-face {font-family:等线; panose-1:2 1 6 0 3 1 1 1 1 1; mso-font-alt:DengXian; mso-font-charset:134; mso-generic-font-family:auto; mso-font-pitch:variable; mso-font-signature:-1610612033 953122042 22 0 262159 0;} @font-face {font-family:"\\@等线"; panose-1:2 1 6 0 3 1 1 1 1 1; mso-font-alt:"\\@DengXian"; mso-font-charset:134; mso-generic-font-family:auto; mso-font-pitch:variable; mso-font-signature:-1610612033 953122042 22 0 262159 0;} /\* Style Definitions \*/ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:""; margin-top:0in; margin-right:0in; margin-bottom:8.0pt; margin-left:0in; text-align:justify; text-justify:inter-ideograph; line-height:106%; mso-pagination:none; font-size:11.0pt; font-family:等线; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:1.0pt; mso-ligatures:standardcontextual;} p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph {mso-style-priority:34; mso-style-unhide:no; mso-style-qformat:yes; margin-top:0in; margin-right:0in; margin-bottom:8.0pt; margin-left:.5in; mso-add-space:auto; text-align:justify; text-justify:inter-ideograph; line-height:106%; mso-pagination:none; font-size:11.0pt; font-family:等线; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:1.0pt; mso-ligatures:standardcontextual;} p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst {mso-style-priority:34; mso-style-unhide:no; mso-style-qformat:yes; mso-style-type:export-only; margin-top:0in; margin-right:0in; margin-bottom:0in; margin-left:.5in; mso-add-space:auto; text-align:justify; text-justify:inter-ideograph; line-height:106%; mso-pagination:none; font-size:11.0pt; font-family:等线; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:1.0pt; mso-ligatures:standardcontextual;} p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle {mso-style-priority:34; mso-style-unhide:no; mso-style-qformat:yes; mso-style-type:export-only; margin-top:0in; margin-right:0in; margin-bottom:0in; margin-left:.5in; mso-add-space:auto; text-align:justify; text-justify:inter-ideograph; line-height:106%; mso-pagination:none; font-size:11.0pt; font-family:等线; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:1.0pt; mso-ligatures:standardcontextual;} p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast {mso-style-priority:34; mso-style-unhide:no; mso-style-qformat:yes; mso-style-type:export-only; margin-top:0in; margin-right:0in; margin-bottom:8.0pt; margin-left:.5in; mso-add-space:auto; text-align:justify; text-justify:inter-ideograph; line-height:106%; mso-pagination:none; font-size:11.0pt; font-family:等线; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:1.0pt; mso-ligatures:standardcontextual;} p.msonormal0, li.msonormal0, div.msonormal0 {mso-style-name:msonormal; mso-style-unhide:no; mso-margin-top-alt:auto; margin-right:0in; mso-margin-bottom-alt:auto; margin-left:0in; mso-pagination:widow-orphan; font-size:12.0pt; font-family:"Times New Roman",serif; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast;} span.SpellE {mso-style-name:""; mso-spl-e:yes;} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-size:10.0pt; mso-ansi-font-size:10.0pt; mso-bidi-font-size:10.0pt; mso-ascii-font-family:等线; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:"Times New Roman"; mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:等线; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:"Times New Roman"; mso-bidi-theme-font:minor-bidi; mso-font-kerning:0pt; mso-ligatures:none;} @page WordSection1 {size:595.3pt 841.9pt; margin:1.0in 1.0in 1.0in 1.0in; mso-header-margin:42.55pt; mso-footer-margin:49.6pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} /\* List Definitions \*/ @list l0 {mso-list-id:154415295; mso-list-type:hybrid; mso-list-template-ids:931790936 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;} @list l0:level1 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l0:level2 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l0:level3 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l0:level4 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l0:level5 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l0:level6 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l0:level7 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l0:level8 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l0:level9 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l1 {mso-list-id:646932171; mso-list-type:hybrid; mso-list-template-ids:1817235478 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;} @list l1:level1 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l1:level2 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l1:level3 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l1:level4 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l1:level5 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l1:level6 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l1:level7 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Symbol;} @list l1:level8 {mso-level-number-format:bullet; mso-level-text:o; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:"Courier New";} @list l1:level9 {mso-level-number-format:bullet; mso-level-text:; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in; font-family:Wingdings;} @list l2 {mso-list-id:1930889031; mso-list-type:hybrid; mso-list-template-ids:-1524617046 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;} @list l2:level1 {mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level2 {mso-level-number-format:alpha-lower; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level3 {mso-level-number-format:roman-lower; mso-level-tab-stop:none; mso-level-number-position:right; text-indent:-9.0pt;} @list l2:level4 {mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level5 {mso-level-number-format:alpha-lower; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level6 {mso-level-number-format:roman-lower; mso-level-tab-stop:none; mso-level-number-position:right; text-indent:-9.0pt;} @list l2:level7 {mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level8 {mso-level-number-format:alpha-lower; mso-level-tab-stop:none; mso-level-number-position:left; text-indent:-.25in;} @list l2:level9 {mso-level-number-format:roman-lower; mso-level-tab-stop:none; mso-level-number-position:right; text-indent:-9.0pt;} ol {margin-bottom:0in;} ul {margin-bottom:0in;} -->

**Part 1**

·       **Example: Blink it Up**: verify and upload, and confirmed the light is blinking.

·       **Example4\_Serial**: change the baud to 9600, verify, and upload.

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image002.png)

·       **Example4\_Serial**: switch the serial monitor’s baud speed to 115200 baud, verify, and upload:

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image004.png)

after holding the board in hand for 60 seconds, temp increased significantly:

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image006.png)

·       **Example1\_MicrophoneOutput:**

          switch the serial monitor’s baud speed to 115200 baud, verify, and upload:

          ![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image008.png)

          Scratch on the board, the sound’s frequency became:

          ![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image010.png)

**Part 2**

**Goal**

          Understanding that Artemis can use Bluetooth to communicate with computer in terms of Characteristics; There’re multiple Characteristics, such as float Characteristics and string Characteristics. We can use ble.receive\_string(uuid) to receive a known message, but in lots of cases we don’t know if there is a message await us, so it’s better to use ble.start\_notify(uuid, notification\_handler), which continuously listen to messages from the given uuid.

**Prelab**

Following the instructions in Lab1 course page, running following commands in powershell to get the environment ready:

python -m pip install --user virtualenv

python -m venv FastRobots\_ble

For the older computer with both python 2 and 3, use ‘python3’ instead of ‘python’.

Once we have the environment, next is activate the Virtual environment by

.\\FastRobots\_ble\\Scripts\\activate

And install Juypter Notebook with

          pip install numpy pyyaml colorama nest\_asyncio bleak jupyterlab

Then simply put the given codebase into the environment, we are ready to start tasks.

·       **T1 Send ECHO command**

          ![A computer screen shot of a computer code
Description automatically generated](lab1%20Write-up_files/image011.png)

·       **T2. Programming and use GET\_TIME\_MILLIS command**

   ![A computer screen shot of a computer code
Description automatically generated](lab1%20Write-up_files/image012.png)

·       **T3. notification handler**

After setting up the notification handler, once Artemis send a message, Juypter notebook will immediately receive it and print in on screen; I used 1 if condition to determine incoming characteristic is string or float, another nested if condition for the time stamp and temperature extraction for later tasks.

![A screenshot of a computer code
Description automatically generated](lab1%20Write-up_files/image014.png)

For example, once CMD.GET\_TIME\_MILLIS lets the Artemis send the current time “T:215108.0”, Juypter notebook receive and print it.

·       **T4**. **Get current time stamps**

I implemented a function in ble\_arduino to send 100 time stamps. I didn’t choose larger amount of time stamps to avoid running of memory.

![A screen shot of a computer code
Description automatically generated](lab1%20Write-up_files/image016.png)

And when I sent the commend from python, 100 results are sent back from Artemis:

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image018.png)

Average data transfer rate = 47.755 strings/s = 334.3 bytes/s

·       **T5. Get, store, and sent time stamps--SEND\_TIME\_DATA command**

I implemented a function in ble\_arduino to send 105 time stamps. I used 15\*7 nested loop instead of 105 loop to overcome the Estring size limitation problem: in this case, the length of the Estring tx\_estring\_value is ensured to be less than 150 before I clear its content;

![A screenshot of a computer program
Description automatically generated](lab1%20Write-up_files/image020.png)

And when I sent the commend from python, 105 results are sent back from Artemis:

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image022.png)

Average data recording rate = 52500 strings/s = 420000 bytes/s

·       **T6. Send time& temperature--GET\_TEMP\_READINGS**

Added a nested if condition to extract time stamp and temperature from the string characteristic. I chose ‘;’ as delimiter because it’s not used in the raw data.

![A screenshot of a computer code
Description automatically generated](lab1%20Write-up_files/image024.png)

![A screenshot of a computer
Description automatically generated](lab1%20Write-up_files/image025.png)

Average data recording rate = 3225.8 strings/s = 48387.1 bytes/s

·       **T7. Compare and Contrast**

The first method(sending while reading data) is more than 1000 slower than the second method(recording all before sending data). If the memory of the board is very limited, the first method could be the preferred option; Otherwise, the second method is better since robots’ data are time-sensitive and a faster rate is desired in general.

386kB of RAM means the red board can store 48250 time stamps (assume time is 7 bytes long and delimiter is 1 byte long) or 55143 temperature readings (assume the reading is 6 bytes long and delimiter is 1 byte long).

**Conclusion, Challenges,** **and Solutions**

1.     When I try to implemented the notification handler, I didn’t realize that the uuid passed into the handler is GATT Characteristic rather than string, and that the way to get the string uuid is to uuid.uuid instead of uuid.uuid(), as .uuid is defined as a property, not a function; after reading forum and asking in Ed, I find these facts, and successfully implemented the notification handler which is able to deal both float and string.

2.     On task 5, my original codes was not able to print out anything except crush the programming and disconnect the board; after printing out values inside the loops, I realized that it’s caused by the 150 transmission length limitation; I resolved that by using a nested loop.

·       Through these tasks, I have successfully built up the Bluetooth connection between Artemis board and computer, enable the GATTCharacteristic data transmission, and found the limitation of Artemis’s transmission speed & storage.