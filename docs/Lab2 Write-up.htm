<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:等线;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@DengXian";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	font-size:11.0pt;
	font-family:等线;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	font-size:11.0pt;
	font-family:等线;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	font-size:11.0pt;
	font-family:等线;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	font-size:11.0pt;
	font-family:等线;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	font-size:11.0pt;
	font-family:等线;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><b><u><span style='text-decoration:none'>&nbsp;</span></u></b></p>

<p class=MsoNormal><b><u><span style='font-size:16.0pt;line-height:107%'>Set up
the IMU</span></u></b></p>

<p class=MsoNormal>My connection:</p>

<p class=MsoNormal>            <u><img width=365 height=396
src="Lab2%20Write-up_files/image001.jpg"
alt="A red circuit board with wires&#10;&#10;Description automatically generated"></u></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Connect IMU, Artemis, and PC together, try the IMU example codes:
</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.25in'><img width=686
height=151 src="Lab2%20Write-up_files/image002.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"> </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>AD0_VAL</i> is the last bit of I2C address of IMU, set it to 0
since we haven’t soldered 2 IMU pads and enabled the ADR jumper yet. </p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Accelerometer measures the acceleration of IMU board, the
gyroscope measures the angular acceleration of the board. In motions such as rotate
or flip the IMU, both acceleration and gyroscope readings change; when
accelerate it, only the accelerometer;s reading changes; In angular motions,
accelerometer’s reading are changed according to current IMU orientation, but
gyroscope’s reading only changes when there’s movements, i.e. when IMU is
stationary with an angle to the desk, the former’s reading don’t necessarily be
0, but the later’s is around 0. </p>

<p class=MsoNormal style='margin-left:.25in'>&nbsp;</p>

<p class=MsoNormal style='margin-left:.25in'>&nbsp;</p>

<p class=MsoNormal><b><u><span style='font-size:16.0pt;line-height:107%'>Accelerometer</span></u></b></p>

<p class=MsoNormal><u>Roll&amp;Pitch with angles at {-90, 0, 90} degrees</u></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>When roll is 90 degrees, the reading from accelerometer is 87~88,
error is less than 3%, is acceptable, thus the accelerometer can be considered
as accurate:</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=601 height=208 src="Lab2%20Write-up_files/image003.png"
alt="A graph with purple lines&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal style='margin-left:.5in'> </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>When pitch is -90 degrees, the reading from accelerometer is
-87~-89, the error is less than 3%, the accelerometer can be considered as
accurate:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=601 height=210 src="Lab2%20Write-up_files/image004.png"
alt="A green line graph on a white background&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The equation used to calculate these are 180 / M_PI *
atan2(sensor-&gt;accY() and 180 / M_PI * atan2(sensor-&gt;accX(),
sensor-&gt;accZ()), 2, 0), sensor-&gt;accZ()), 2, 0), which is essentially the
2 equations mentioned in lecture: </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=217 height=66 src="Lab2%20Write-up_files/image005.png"
alt="A black background with white text&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the graph above, the accuracy of the accelerometer can be
shown. It has some error, but within the acceptence range. </p>

<p class=MsoNormal style='margin-left:.25in'><u>Analysis of accelerometer’s
noise</u></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><u>When pounding the table, the Fourier graph looks like:</u></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=512 height=402 src="Lab2%20Write-up_files/image006.png"
alt="A graph of a number of objects&#10;&#10;Description automatically generated with medium confidence"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>It is easy to tell there’s high frequency noise.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Using the formula from lecture, </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'><img width=374
height=214 src="Lab2%20Write-up_files/image007.png"
alt="A black screen with white text&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>I implemented a
Low pass filter:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'><img width=602
height=259 src="Lab2%20Write-up_files/image008.png"
alt="A computer screen shot of a code&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>With this low pass filter, the high frequency errors are reduced
a lot:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><img width=549 height=422 id="Picture 3"
src="Lab2%20Write-up_files/image009.png"
alt="A graph of a number of blue and orange lines&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Simulate the noise by tapping the table, then draw the Fourier
graph, and we can see there’ s no significant high frequency noise. This might be
because of the IMUS’s internal low pass filter.  </p>

<p class=MsoNormal><b><u><span style='font-size:16.0pt;line-height:107%'>Gyroscope</span></u></b></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The degree measurement by gyroscope is implemented using the
formula from lecture notes: </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=277 height=29 src="Lab2%20Write-up_files/image010.png"></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Substitute the values into the equation, I got the following
code: </p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
background:white'><a name="OLE_LINK1"><span style='color:black'>            </span></a><span
style='font-size:13.5pt;font-family:Consolas;color:black'>&nbsp; </span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>roll_gy += </span><span
style='font-size:13.5pt;font-family:Consolas;color:#098658'>0.006935</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'> * </span><span
style='font-size:13.5pt;font-family:Consolas;color:#001080'>sensor</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>-&gt;</span><span
style='font-size:13.5pt;font-family:Consolas;color:#795E26'>gyrX</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>();</span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:18.0pt;background:white'><span style='font-size:13.5pt;font-family:
Consolas;color:black'>     &nbsp; pitch_gy += </span><span style='font-size:
13.5pt;font-family:Consolas;color:#098658'>0.006935</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'> * </span><span
style='font-size:13.5pt;font-family:Consolas;color:#001080'>sensor</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>-&gt;</span><span
style='font-size:13.5pt;font-family:Consolas;color:#795E26'>gyrY</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>();</span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:18.0pt;background:white'><span style='font-size:13.5pt;font-family:
Consolas;color:black'>     &nbsp; yaw_gy += </span><span style='font-size:13.5pt;
font-family:Consolas;color:#098658'>0.006935</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'> * </span><span style='font-size:13.5pt;
font-family:Consolas;color:#001080'>sensor</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>-&gt;</span><span style='font-size:13.5pt;
font-family:Consolas;color:#795E26'>gyrZ</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>();</span></p>

<p class=MsoListParagraphCxSpFirst>where the number 0.006935 is the time
between each measurement, the dt. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Graph of roll’s and pitch’s readings</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Roll:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=614 height=203 src="Lab2%20Write-up_files/image011.png"
alt="A graph on a white background&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Pitch:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=601 height=210 src="Lab2%20Write-up_files/image012.png"
alt="A graph on a white background&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Comparison between the diagram of gyroscope and accelerometer:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=602 height=202 id="Picture 2"
src="Lab2%20Write-up_files/image013.jpg"
alt="A close-up of a computer screen&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>The sketch of gyroscope is much smoother than that of
accelerometer, but it has a continuous drifting. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The design of complimentary filter and choice of parameter</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=350 height=38 src="Lab2%20Write-up_files/image014.png"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>I used the equation above. The value of alpha I chose was 0.5,
which makes the final curve smoothy without having too much drifting:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span>Roll</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><img width=498 height=162 src="Lab2%20Write-up_files/image015.png"
alt="A graph with a line drawn on it&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span>Pitch    </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><img width=491 height=162 src="Lab2%20Write-up_files/image016.png"
alt="A green line graph on a white background&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.5in;text-indent:-.25in'><span
style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span>&nbsp;</p>

<p class=MsoNormal><u><span style='text-decoration:none'>&nbsp;</span></u></p>

<p class=MsoNormal><b><u><span style='font-size:16.0pt;line-height:107%'>Data
collection</span></u></b></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>When I was dealing with data collection, I had trouble with
sending all data to computer using Bluetooth, but fortunately I got solution in
the end: improve the size of the data by using simplest notations for parsing
only, and split it, then store the data needed into an array(see the code graph
below): </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=517 height=201 src="Lab2%20Write-up_files/image017.png"
alt="A white background with black numbers&#10;&#10;Description automatically generated"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>In the picture above, among every 3 numbers splited by ‘|’, the 1<sup>st</sup>
is millitime, 2<sup>nd</sup> is row, the 3<sup>rd</sup> is pitch. The sampling
time interval is 0.006935, which is got by measuring the average interval. </p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=318 height=187 src="Lab2%20Write-up_files/image018.png"
alt="A screenshot of a computer code&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>By adding enough sampling data point in the ble_arduino, I got a
7 seconds IMU data with time stamp:</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><img width=602 height=554 id="Picture 1"
src="Lab2%20Write-up_files/image019.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

</div>

</body>

</html>
